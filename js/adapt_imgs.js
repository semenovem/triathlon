"use strict";function _objectSpread(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.forEach(function(n){_defineProperty(e,n,r[n])})}return e}function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var adaptImgs={app:null,_REQ_HIDE:/hide|none/,init:function(e){this.app=e,this._handleChangeScreen=this._handleChangeScreen.bind(this),this._findImgs(e.screen),this.app.addEventListener("changeScreen",this._handleChangeScreen)},_handleChangeScreen:function(e){this._findImgs(e.screen)},_findImgs:function(e){var n=this,r=document.querySelectorAll("[data-src]");Array.from(r).map(function(e){return _objectSpread({el:e},n._parseDataSrc(e.getAttribute("data-src")))}).map(function(e){return e.baseUrl||(e.baseUrl=n._minusSuffix(e.el.src)),e}).filter(function(e){return e.baseUrl}).map(this._calcScreenForImg,this).forEach(function(n){var r=n.el,t=n.screen[e];null!==t?r.src!==t&&(r.src=t):r.src&&(r.src="")})},_parseDataSrc:function(e){var n=this,r={baseUrl:"",screen:{}},t=this.app.screenHash;return e.split(/\s+/).filter(Boolean).forEach(function(e){if(n._isUrlImg(e))r.baseUrl=e;else{var a=e.slice(0,2);if(t[a]){var c=e.slice(2).match(/[\d\w]+$/i);r.screen[a]=c?c[0]:""}}}),r},_calcScreenForImg:function(e){var n,r=this,t=this.app.screenList,a=e.screen,c=e.baseUrl;return t.map(function(e){return a[e]&&r._REQ_HIDE.test(a[e])&&(a[e]=null),e}).map(function(e){switch(a[e]){case null:break;case void 0:void 0!==n&&(a[e]=n);break;default:a[e]=r._sumUrl(c,a[e]?a[e]:e)}return n=a[e],e}).reverse().forEach(function(e,r){switch(0===r&&(n=void 0),a[e]){case null:break;case void 0:void 0!==n&&(a[e]=n)}n=a[e]}),e},_isUrlImg:function(e){return/\.(jpg|png|svg)$/.test(e)},_sumUrl:function(e,n){return e.replace(/(.+)\.(jpg|png|svg)/,"$1--".concat(n,".$2"))},_minusSuffix:function(e){return e.replace(/(.*?)--.+?\.(jpg|png|svg)/,"$1.$2")}};app.domContentLoaded.then(adaptImgs.init.bind(adaptImgs,app));